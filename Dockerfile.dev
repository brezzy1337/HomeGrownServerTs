FROM node:20.11-alpine3.18

RUN addgroup dev && adduser -S -G dev dev && apk add --no-cache make gcc g++ python3

WORKDIR /app

USER dev

COPY package*.json ./

ENV npm_config_build_from_source=true

RUN npm ci

COPY . .

ENV PORT=8080

EXPOSE 8080

CMD [ "prisma", "generate", && "npm","run", "start:dev" ]
